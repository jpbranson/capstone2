<html lang="en">
<head>
  <title>Cities</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://github.com/douglascrockford/JSON-js/blob/master/json2.js"></script>
  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js" type="text/javascript"></script>  
          <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {
        'packages':['geochart'],
        // Note: you will need to get a mapsApiKey for your project.
        // See: https://developers.google.com/chart/interactive/docs/basic_load_libs#load-settings
        'mapsApiKey': 'AIzaSyC1R-o3SRuU3mDj-Iyj3cYmPZce_FXFg4o'
      });
      google.charts.setOnLoadCallback(drawVisualization);
      function drawVisualization() {
            //Get the Rest url
        //var url = "http://45.35.64.128:8000/getmsa";
        
		//Request json data
		//$.getJSON(url, function(data){

         var data = google.visualization.arrayToDataTable([
            ['City'],            
            ['Abilene'],
            ['Akron'],
            ['Albany'],
            ['Albany Schenectady Troy'],
            ['Albuquerque'],
            ['Alexandria'],
            ['Allentown Bethlehem Easton'],
            ['Altoona'],
            ['Amarillo'],
            ['Ames'],
            ['Anchorage'],
            ['Ann Arbor'],
            ['Appleton'],
            ['Asheville'],
            ['Athens Clarke County'],
            ['Atlanta Sandy Springs Roswell'],
            ['Atlantic City Hammonton'],
            ['Auburn Opelika'],
            ['Augusta Richmond County'],
            ['Austin Round Rock'],
            ['Bakersfield'],
            ['Baltimore Columbia Towson'],
            ['Bangor'],
            ['Barnstable Town'],
            ['Baton Rouge'],
            ['Battle Creek'],
            ['Bay City'],
            ['Beaumont Port Arthur'],
            ['Bellingham'],
            ['Bend Redmond'],
            ['Billings'],
            ['Binghamton'],
            ['Birmingham Hoover'],
            ['Bismarck'],
            ['Blacksburg Christiansburg Radford'],
            ['Bloomington IL'],
            ['Bloomington IN'],
            ['Boise City'],
            ['Boston Cambridge Newton'],
            ['Boulder'],
            ['Bowling Green'],
            ['Bremerton Silverdale'],
            ['Bridgeport Stamford Norwalk'],
            ['Brownsville Harlingen'],
            ['Brunswick'],
            ['Buffalo Cheektowaga Niagara Falls'],
            ['Burlington NC'],
            ['Burlington South Burlington VT'],
            ['Canton Massillon'],
            ['Cape Coral Fort Myers'],
            ['Cape Girardeau'],
            ['Carson City'],
            ['Casper'],
            ['Cedar Rapids'],
            ['Champaign Urbana'],
            ['Charleston'],
            ['Charleston North Charleston'],
            ['Charlotte Concord Gastonia'],
            ['Charlottesville'],
            ['Chattanooga'],
            ['Cheyenne'],
            ['Chicago Naperville Elgin'],
            ['Chico'],
            ['Cincinnati'],
            ['Clarksville'],
            ['Cleveland'],
            ['Cleveland Elyria'],
            ["Coeur d'Alene"],
            ['College Station Bryan'],
            ['Colorado Springs'],
            ['Columbia'],
            ['Columbia'],
            ['Columbus'],
            ['Columbus'],
            ['Columbus'],
            ['Corpus Christi'],
            ['Corvallis'],
            ['Crestview Fort Walton Beach Destin'],
            ['Cumberland'],
            ['Dallas Fort Worth Arlington'],
            ['Dalton'],
            ['Danville'],
            ['Davenport Moline Rock Island'],
            ['Dayton'],
            ['Decatur'],
            ['Decatur'],
            ['Deltona Daytona Beach Ormond Beach'],
            ['Denver Aurora Lakewood'],
            ['Des Moines West Des Moines'],
            ['Detroit Warren Dearborn'],
            ['Dothan'],
            ['Dover'],
            ['Dubuque'],
            ['Duluth'],
            ['Durham Chapel Hill'],
            ['Eau Claire'],
            ['El Centro'],
            ['Elizabethtown Fort Knox'],
            ['Elkhart Goshen'],
            ['Elmira'],
            ['El Paso'],
            ['Erie'],
            ['Eugene'],
            ['Evansville'],
            ['Fairbanks'],
            ['Fargo'],
            ['Farmington'],
            ['Fayetteville'],
            ['Fayetteville Springdale Rogers'],
            ['Flagstaff'],
            ['Flint'],
            ['Florence'],
            ['Florence Muscle Shoals'],
            ['Fond du Lac'],
            ['Fort Collins'],
            ['Fort Smith'],
            ['Fort Wayne'],
            ['Fresno'],
            ['Gadsden'],
            ['Gainesville'],
            ['Gainesville'],
            ['Glens Falls'],
            ['Goldsboro'],
            ['Grand Forks'],
            ['Grand Junction'],
            ['Grand Rapids Wyoming'],
            ['Great Falls'],
            ['Greeley'],
            ['Green Bay'],
            ['Greensboro High Point'],
            ['Greenville'],
            ['Greenville Anderson Mauldin'],
            ['Gulfport Biloxi Pascagoula'],
            ['Hagerstown Martinsburg'],
            ['Hanford Corcoran'],
            ['Harrisburg Carlisle'],
            ['Harrisonburg'],
            ['Hartford West Hartford East Hartford'],
            ['Hattiesburg'],
            ['Hickory Lenoir Morganton'],
            ['Hinesville'],
            ['Hot Springs'],
            ['Houma Thibodaux'],
            ['Houston The Woodlands Sugar Land'],
            ['Huntington Ashland,WV'], 
            ['Huntsville,AL'],
            ['Idaho Falls,ID'],
            ['Indianapolis Carmel Anderson,IN'],
            ['Iowa City,IA'],
            ['Ithaca,NY'],
            ['Jackson,MI'],
            ['Jackson,MS'],
            ['Jackson,TN'],
            ['Jacksonville,FL'],
            ['Jacksonville,NC'],
            ['Jefferson City,MO'],
            ['Johnson City,TN'],
            ['Johnstown'],
            ['Jonesboro'],
            ['Joplin'],
            ['Kalamazoo Portage'],
            ['Kankakee'],
            ['Kansas City'],
            ['Kennewick Richland'],
            ['Killeen Temple'],
            ['Kingsport Bristol Bristol,TN,VA'],
            ['Kingston,NY'],
            ['Knoxville,TN'],
            ['Kokomo,IN'],
            ['La Crosse Onalaska,WI'],
            ['Lafayette,LA'],
            ['Lafayette West Lafayette,IN'],
            ['Lake Charles'],
            ['Lake Havasu City Kingman'],
            ['Lakeland Winter Haven'],
            ['Lancaster'],
            ['Lansing East Lansing'],
            ['Laredo'],
            ['Las Cruces'],
            ['Las Vegas Henderson Paradise'],
            ['Lawrence,KS'],
            ['Lawton,OK'],
            ['Lebanon,PA'],
            ['Lewiston ID WA'],
            ['Lewiston Auburn,ME'],
            ['Lexington Fayette,KY'],
            ['Lima'],
            ['Lincoln'],
            ['Little Rock North Little Rock Conway'],
            ['Logan UT,ID'],
            ['Longview,TX'],
            ['Longview,WA'],
            ['Los Angeles Long Beach Anaheim'],
            ['Louisville/Jefferson County'],
            ['Lubbock'],
            ['Lynchburg'],
            ['Macon Bibb County'],
            ['Madera'],
            ['Madison'],
            ['Manchester Nashua'],
            ['Manhattan'],
            ['Mankato North Mankato'],
            ['Mansfield'],
            ['McAllen Edinburg Mission'],
            ['Medford'],
            ['Memphis TN'],
            ['Merced CA'],
            ['Miami Fort Lauderdale West Palm Beach'],
            ['Michigan City La Porte'],
            ['Midland'],
            ['Milwaukee Waukesha West Allis'],
            ['Minneapolis St. Paul Bloomington'],
            ['Missoula MT'],
            ['Mobile AL'],
            ['Modesto CA'],
            ['Monroe LA'],
            ['Monroe MI'],
            ['Montgomery AL'],
            ['Morgantown WV'],
            ['Morristown TN'],
            ['Mount Vernon Anacortes WA'],
            ['Muncie IN'],
            ['Muskegon MI'],
            ['Myrtle Beach Conway North Myrtle Beach'],
            ['Napa'],
            ['Naples Immokalee Marco Island'],
            ['Nashville Davidson  Murfreesboro  Franklin'],
            ['New Haven Milford'],
            ['New Orleans Metairie'],
            ['New York Newark Jersey City'],
            ['Niles Benton Harbor'],
            ['North Port Sarasota Bradenton'],
            ['Norwich New London CT'],
            ['Ocala FL'],
            ['Ocean City NJ'],
            ['Odessa'],
            ['Ogden Clearfield UT'],
            ['Oklahoma City OK'],
            ['Olympia Tumwater WA'],
            ['Omaha Council Bluffs NE IA'],
            ['Orlando Kissimmee Sanford FL'],
            ['Oshkosh Neenah WI'],
            ['Owensboro KY'],
            ['Oxnard Thousand Oaks Ventura CA'],
            ['Palm Bay Melbourne Titusville FL'],
            ['Panama City FL'],
            ['Parkersburg Vienna WV'],
            ['Pensacola Ferry Pass Brent FL'],
            ['Peoria IL'],
            ['Philadelphia Camden Wilmington PA NJ DE MD'],
            ['Phoenix Mesa Scottsdale AZ'],
            ['Pine Bluff AR'], 
            ['Pittsburgh,PA'],
            ['Pittsfield MA'],
            ['Pocatello ID'],
            ['Portland South Portland ME'],
            ['Portland Vancouver Hillsboro OR WA'],
            ['Port St. Lucie FL'],
            ['Prescott AZ'],
            ['Providence Warwick RI MA'],
            ['Provo Orem UT'],
            ['Pueblo CO'],
            ['Punta Gorda FL'],
            ['Racine WI'],
            ['Raleigh NC'],
            ['Rapid City SD'],
            ['Reading PA'],
            ['Redding CA'],
            ['Reno NV'],
            ['Richmond VA'],
            ['Riverside San Bernardino Ontario CA'],
            ['Roanoke VA'],
            ['Rochester MN'],
            ['Rochester NY'],
            ['Rockford IL'],
            ['Rocky Mount NC'],
            ['Rome GA'],
            ['Sacramento Roseville Arden Arcade CA'],
            ['Saginaw'],
            ['Salem'],
            ['Salinas'],
            ['Salisbury'],
            ['Salt Lake City'],
            ['San Angelo'],
            ['San Antonio New Braunfels'],
            ['San Diego Carlsbad'],
            ['San Francisco Oakland Hayward'],
            ['San Jose Sunnyvale Santa Clara'],
            ['San Luis Obispo Paso Robles Arroyo Grande'],
            ['Santa Cruz Watsonville'],
            ['Santa Fe'],
            ['Santa Maria Santa Barbara'],
            ['Santa Rose'],
            ['Savannah'],
            ['Scranton–Wilkes Barre–Hazleton'],
            ['Seattle Tacoma Bellevue'],
            ['Sebastian Vero Beach'],
            ['Sheboygan'],
            ['Sherman Denison'],
            ['Shreveport Bossier City'],
            ['Sioux City'],
            ['Sioux Falls'],
            ['South Bend Mishawaka'],
            ['Spartanburg'],
            ['Spokane Spokane Valley'],
            ['Springfield'],
            ['Springfield'],
            ['Springfield'],
            ['Springfield'],
            ["St. Cloud"],
            ['St. George'],
            ['St. Joseph'],
            ['St. Louis'],
            ['State College'],
            ['Stockton Lodi'],
            ['Sumter'],
            ['Syracuse'],
            ['Tallahassee'],
            ['Tampa St. Petersburg Clearwater'],
            ['Terre Haute'],
            ['Texarkana'],
            ['Toledo'],
            ['Topeka'],
            ['Trenton'],
            ['Tucson'],
            ['Tulsa'],
            ['Tuscaloosa'],
            ['Tyler'],
            ['Utica Rome'],
            ['Valdosta'],
            ['Vallejo Fairfield'],
            ['Victoria'],
            ['Vineland Bridgeton'],
            ['Virginia Beach Norfolk Newport News'],
            ['Visalia Porterville'],
            ['Waco'],
            ['Warner Robins'],
            ['Washington Arlington Alexandria'],
            ['Waterloo Cedar Falls'],
            ['Wausau'],
            ['Wheeling'],
            ['Wichita Falls'],
            ['Wichita'],
            ['Williamsport'],
            ['Wilmington'],
            ['Winchester'],
            ['Winston Salem'],
            ['Worcester'],
            ['Yakima'],
            ['York Hanover'],
            ['Youngstown Warren Boardman'],
            ['Yuba City'],
            ['Yuma']
         ]);

         var geochart = new google.visualization.GeoChart(
      document.getElementById('visualization'));
  geochart.draw(data,{displayMode: 'markers',width:1500,height:550,region: "US", resolution: "provinces",colorAxis: {colors: ['#e7711c', '#4374e0']}});
}
      </script>
  <style>

    /* Remove the navbar's default margin-bottom and rounded borders */
    .navbar {
      margin-bottom: 0;
      border-radius: 0;
    }

    .carousel-inner>.item>a>img, .carousel-inner>.item>img, .img-responsive, .thumbnail a>img, .thumbnail>img {
        height: 200px !important;
        width: 100%;
    }

    /* Add a gray background color and some padding to the footer */
    footer {
      background-color: #f2f2f2;
      padding: 25px;
    }
  </style>
  </head>
<body id="myPage" data-spy="scroll" data-target=".navbar" data-offset="50">

  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>                        
        </button>
        <a class="navbar-brand" href="#myPage">Logo</a>
      </div>
      <div class="collapse navbar-collapse" id="myNavbar">
      <li><a href="http://100.26.173.170:8080">HOME</a></li>
        <ul>
        <li><a href="http://100.26.173.170:8080/analytics">Analytics</a></li>
        <li><a href="http://100.26.173.170:8080/source">Data Sources</a></li>
        <li><a onClick="window.location='http://100.26.173.170:8080/home#band'">About US</a></li>
        </ul>
      </div>
    </div>
  </nav>

<div class="jumbotron">
  <div class="container text-center">
    <h1>City View</h1>
    <p>Quick Review of details of the cities in USA on MAP</p>
  </div>
      <div id="visualization" style="width: 900px; height: 500px;"></div>
 </div>
<div>
      <h3> List of Cities:</h3>
       <form action="">
        <h2> MSA:</h2>
         <select id="locality-dropdown" name="locality" onchange="onSelectChange(event)">
           <!-- <option selected="true">Choose State/Province</option> -->
         </select>
<!-- <input type="submit"> -->
</form>
<script>
  
  if($(document).ready()) {
let dropdown = document.getElementById('locality-dropdown');
dropdown.length = 0;

let defaultOption = document.createElement('option');
defaultOption.text = 'Choose State/Province';

dropdown.add(defaultOption);
dropdown.selectedIndex = 0;

const url = 'http://45.35.64.128:8000/getmsa';

const request = new XMLHttpRequest();
request.open('GET', url, true);
request.withCredentials = true;
request.setRequestHeader("Access-Control-Allow-Origin","*");

request.setRequestHeader("Access-Control-Allow-Credentials", "true");
request.setRequestHeader("Access-Control-Allow-Methods", "GET,HEAD,OPTIONS,POST,PUT");
request.setRequestHeader("Access-Control-Allow-Headers", "Access-Control-Allow-Headers, Origin,Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers");

request.onload = function() {
  console.log(request.status);
  if (request.status === 200) {
    const data = JSON.parse(request.responseText);
    let option;
    for (let i = 0; i < data.length; i++) {
      option = document.createElement('option');
      option.text = data[i].MSA;
      option.value = data[i].MSA;
      dropdown.add(option);
    }
   }else {
    console.console.log("Reached the server, but it returned an error");
  }
}

request.onerror = function() {
  console.error('An error occurred fetching the JSON from ' + url);
  // console.error(error);
};

request.send();
}

function onSelectChange(val){
      console.log('selected event', val.target.selectedOptions[0].innerText);
  //    params = val.target.selectedOptions[0].innerText;
  localStorage.setItem('city',  val.target.selectedOptions[0].innerText);
      var http = new XMLHttpRequest();
  var url = 'http://45.35.64.128:8000/msadetails?MSA='+val.target.selectedOptions[0].innerText;
//  var data = params ;
  http.open('GET', url, true);
  http.withCredentials = true;

  //Send the proper header information along with the request
  http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
http.setRequestHeader("Access-Control-Allow-Origin","*");

http.setRequestHeader("Access-Control-Allow-Credentials", "true");
http.setRequestHeader("Access-Control-Allow-Methods", "GET,HEAD,OPTIONS,POST,PUT");
// http.setHeader("Access-Control-Allow-Headers", "Access-Control-Allow-Headers, Origin,Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers");



  http.onreadystatechange = function() {//Call a function when the state changes.
      if(http.readyState == 4 && http.status == 200) {
        //alert(http.responseText);
      window.location="details.html" ;

      }
  }
  http.send(val.target.selectedOptions[0].innerText)
}

</script>
</div>
<footer class="container-fluid text-center"></footer>
</body>
</html>
